\documentclass[a4paper,10pt]{scrreprt}
\usepackage[top=2cm,left=2cm,right=2cm]{geometry}
\usepackage[utf8]{inputenc}
\usepackage{graphicx}
\usepackage[english]{babel}
%opening
\title{.NET Enterprise Applications}
\author{Roland Hediger}
\usepackage{fancyhdr}
\renewcommand{\familydefault}{\sfdefault}
\newcommand{\pic}[2][figure]{\begin{figure}[h]
 \centering
 \includegraphics[scale=0.4]{#2}
 % rsc.png: 0x0 pixel, 0dpi, 0.00x0.00 cm, bb=
 \caption{#1}
\end{figure}
}

% Code listenings
\usepackage{color}
 \usepackage{framed}
\definecolor{bluekeywords}{rgb}{0.13,0.13,1}
\definecolor{greencomments}{rgb}{0,0.5,0}
\definecolor{redstrings}{rgb}{0.9,0,0}
\usepackage{xcolor}
\usepackage{listings}
\usepackage{caption}
\DeclareCaptionFont{white}{\color{white}}
\DeclareCaptionFormat{listing}{\colorbox{gray}{\parbox{\textwidth}{#1#2#3}}}
\captionsetup[lstlisting]{format=listing,labelfont=white,textfont=white}
\lstset{language=[Sharp]C,
showspaces=false,
showtabs=false,
breaklines=true,
showstringspaces=false,
breakatwhitespace=true,
escapeinside={(*@}{@*)},
commentstyle=\color{greencomments},
keywordstyle=\color{bluekeywords}\bfseries,
stringstyle=\color{redstrings},
basicstyle=\ttfamily,
 numbers=left,               % Ort der Zeilennummern
 numberstyle=\tiny,          % Stil der Zeilennummern
 stepnumber=5,              % Abstand zwischen den Zeilennummern
 numbersep=5pt,              % Abstand der Nummern zum Text
 tabsize=2,
  basicstyle=\footnotesize\ttfamily
}
\lstdefinelanguage{JavaScript}{
  keywords={typeof, new, true, false, catch, function, return, null, catch, switch, var, if, in, while, do, else, case, 
break},
  keywordstyle=\color{blue}\bfseries,
  ndkeywords={class, export, boolean, throw, implements, import, this},
  ndkeywordstyle=\color{darkgray}\bfseries,
  identifierstyle=\color{black},
  sensitive=false,
  comment=[l]{//},
  morecomment=[s]{/*}{*/},
  commentstyle=\color{purple}\ttfamily,
  stringstyle=\color{red}\ttfamily,
  morestring=[b]',
  morestring=[b]"
}
\begin{document}
\maketitle
\tableofcontents
\newpage
 \pagestyle{fancy}

\part{Prüfung 1}
\chapter{Basics,Intro,TFS}
\footnote{Author welcomes tokens of gratitude in the form of beer, if thy deem this documents helpful for thine test}
\pic[TFS Features]{tfs.png}
\section{TFS Setup}
\begin{description}
\item[On Premises] \begin{itemize}
\item Server Setup
\item Server Unterhalt + Backup
\item Reporting (SQL Reporting Dienst)
\item Sharepoint
\item \textbf{Voll konfigurierbar im vergleich mit TFS}
\end{itemize}
\item[TFS als SAAS Lösung]
\begin{itemize}
\item Kein Server Setup
\item Kein Unterhalt + Backup
\item Saklierbar
\item Data Storage off premises.
\end{itemize}
\item[Additional TFS Features]
\begin{itemize}
\item Sprint Planning
\item Scrum Board
\item Excel Reporting
\end{itemize}
\item [General] Dont waste too much time choosing the right process template. Out of the box experience is sufficient : Source Control, Work Item Types, Basic Reporting
\end{description}

\chapter{Windows Presentation Foundation (WPF)}

\section{Goals of WPF}
\begin{enumerate}
\item Unified approach to UI Docs and Media, replacing the individual technologies GDI, GDI+, Win32 (Winforms)
\item \textbf{Integrated vector-based composition engine} - One graphics engine for whole stack.
\item Declarative programming : Separate UI look and feel (XAML) from programming (Code Behind).
\item Ease of deployment : Allowing administrators to deploy and manage applications securely.
\end{enumerate}

\pic[WPF Architecture]{wpfArchitecture.PNG}

\section{WPF Features}
\subsection{Rendering}
\pic{wrender.png}

\section{XAML}
Extensible Application Markup Langunage, xml based to \textit{instantiate and initialize objects with heirachichal relationships}

\begin{lstlisting} [language=xml,caption=First XAML Example]
<Window xmlns="http://schemas.microsoft.com/winfx/..."> <StackPanel HorizontalAlignment="Center" > <Image Source="Images/hello.jpg" Height="80" /> <TextBlock Text="Welcome to WPF!" FontSize="14"/> <Button Content="OK" Padding="10,4" /> </StackPanel> </Window>
\end{lstlisting}

\begin{description}
\item[General] Markup for windows : Build applications in simple declarative statements. Can be used for any CLR object heirarchy.Code and content are strictly separate, streamlines designer developer collaboration.
\item[XAML vs Code] Everything in XAML can also be done in code. The xml tags correspond to objects using their default constructors, and xml attributes correspond to the UI Object Properties.\\
\pic[xaml vs c\#]{xaml_cs.png}

\item [XAML Prefixes + Property Element Syntax] \hfill \\
\begin{lstlisting}[caption=XAML Prefixes,language=xml]
\begin{lstlisting} [caption=XAML Property Element Syntax]
<Rectangle Width="20" Height="20"> <Rectangle.Fill> <LinearGradientBrush> <GradientStop Color="Red" Offset="0" /> <GradientStop Color="Blue" Offset="1" /> </LinearGradientBrush> </Rectangle.Fill> </Rectangle>
\end{lstlisting}
\item [XAML Compilation] \hfill \\
\pic{xamlcomp.png}
\item [UI Services] \hfill \\
\begin{itemize}
 \item Layout
 \item Controls Library
 \item Templates
 \item Styles and Resources 
\end{itemize}
\begin{lstlisting}[language=xml,caption=Combination of UI Services Example]
<StackPanel>
<StackPanel.Triggers>
<EventTrigger RoutedEvent="Button.Click">
<EventTrigger.Actions>
<BeginStoryboard>
<BeginStoryboard.Storyboard>
<Storyboard>
<ColorAnimation To="Yellow" Duration="0:0:0.5"
Storyboard.TargetName="TheBrush"
Storyboard.TargetProperty="Color" />
<DoubleAnimation To="45" Duration="0:0:2"
Storyboard.TargetName="LowerEllipseTransform"
Storyboard.TargetProperty="Angle" />
...
</StackPanel.Triggers>
... remainder of contents of StackPanel, including x:Name'd
TheBrush and LowerEllipseTransform ...
</StackPanel>
\end{lstlisting}
\item [Flexible Composition] I can define an Item inside the content tag of an Item and it will be used as the parent item's content :
 \begin{lstlisting}[caption=XAML Composition Example,language=xml]
 <Button Width="50">
<Button.Content>
<Image Source="images/windows.jpg"
Height="40"/>
</Button.Content>
</Button>
 \end{lstlisting}
 
\item[Attached Properties] Allows a child element of an object to adjust properites of itsself in relation to the parent object (where it should dock, margins) which are only available due to the type of the parent element.
\begin{lstlisting}[caption=XAML Attached Properties Example,language=xml]
<DockPanel>
<Button DockPanel.Dock="Left" Content="Button" />
</DockPanel>
<Canvas>
<Button Canvas.Top="20" Canvas.Left="20"
Content="Button" />
</Canvas>
\end{lstlisting}
\end{description}
\subsection{User Controls vs Custom Control}
\begin{description}
\item[User controls] are reusable compositions of other controls : Grid with items positioned on it the same way used many times over.
\item[CustomControl] Self explanatory - enhances existing control.
\end{description}
\subsection{Layout Panels , Padding and Alignment}
\pic[WPF Panels]{wlp.png}
\pic[Padding and Alignment]{pal.png}
\begin{itemize}
\item Use Alignment, Padding and Margin to position elements
\item Avoid fix sizes for elements
\item Do not misuse the Canvas Panel for fix positioning of elements (WinForms Style)
\end{itemize}
\subsection{Transformations (Translations/Animations)}
Element can be transformed in WPF
LayoutTransform influences the layout, RenderTransform does not.
\pic{tform.png}
\section{Databinding with XAML}
\begin{lstlisting}[language=xml]
<TextBlock Text="{Binding Path=Vorname}" />
\end{lstlisting}
\begin{itemize}
\item DataBinding synchronizes the values of two properties.
\item Typically UI element is connected to an entity object (POCO / DAO) from a database.
\item Binding cna be Uni or Bidirectional.
\item A ValueConverter can adapt different data formats for syncronization.
\end{itemize}
\pic[Data Binding Diagram]{dbind.png}

\subsection{Data Context}
Every WPF element has a DataContext property.The DataContext is inherited to children.Allows the Binding to a Data-Object.The default source of a {Bindings} is always the DataContext.
\begin{lstlisting}[caption=Data Binding Example,language=xml]
<Button Content="{Binding Name}" />
DataContext = customer1;
\end{lstlisting}
\textbf{Properties:}
\begin{description}
\item [UpdateSourceTrigger] ProperyChanged,LostFocus,Explicit(manual)
\item[Mode] Direction of Databinding : OneWay,TwoWay,OneWayToSource.
\end{description}

\subsection{IPropertyChanged}
Every Data-Object must implement INotifyPropertyChanged to allow the propagation of changes.
\begin{lstlisting}[caption=INotifyPropertyChanged implementation]
public class Customer : INotifyPropertyChanged
{
private string _name;
public string Name
{
get { return _name; }
set
{
_name = value;
NotifyPropertyChanged("Name");
}
}
public event PropertyChangedEventHandler PropertyChanged;
private void NotifyPropertyChanged( string name)
{
if( PropertyChanged != null )
PropertyChanged(this, new PropertyChangedEventArgs(name));
}
}
\end{lstlisting}
\subsection{ObservableCollection}
Use ObservableCollections to allow the propagation of collection changes. 
\begin{verbatim}
ObservableCollection<Auction> auctions
= new ObservableCollection<Auction>();
\end{verbatim}
\subsection{Value Converters}
ValueConverters can change the format of the data in both directions:
\begin{lstlisting}[caption=ValueConverter Example]
public class BoolToVisibilityConverter : IValueConverter
{
#region IValueConverter Members
public object Convert(object value, Type targetType, object parameter,
CultureInfo culture)
{
return (bool) value ? Visibility.Visible : Visibility.Collapsed;
}
public object ConvertBack(object value, Type targetType, object parameter,
CultureInfo culture)
{
throw new NotImplementedException();
}
#endregion
}
\end{lstlisting}
\begin{lstlisting}[caption=ValueConverter in XAML]
<Window.Resources>
<conv:BooleanToStatusTextConverter
x:Key="booleanToStatusTextConverter" />
</Window.Resources>
<Button Content="{Binding IsOpen,
Converter={booleanToStatusTextConverter}}" />
\end{lstlisting}

\subsection{Problems}
DataBinding errors are written to the Debug Output.Use an empty ValueConverter to set breakpoints.


\section{MVVM Pattern}
\begin{description}
\item[Motivation]
\begin{itemize}
\item Separation of GUI design ("style") and logic "behavior".Ability to use Expression Blend.
\item No duplicated code to update views..No "myLabel.Text = newValue" sprinkled in code behind everywhere.
\item Testability: Since your logic is completely agnostic of your view (no "myLabel.Text" references), unit testing is made easy.
\end{itemize}
\end{description}
\pic[MVVM Example]{mvvm.png}
\begin{description}
\item [View(xaml)] Usercontrol based, with xaml. Has minimal code behind. Datacontext is set to the associated View Model. No event Handlers. Data binding of view is set to view model.
\item [View Model(c\#)] Implemenets INotifyPropertyChanged. Exposes ICommand, handles validation. Functions as an adapter class between view and model, as a result, it is testable.
\item [Model] POCO free of all WPF.
\end{description}
\subsection{Commands}
Commands are used to bind UI actions to the ViewModel functionality. A command implements 3 functions of the ICommand interface : 
\begin{verbatim}
Execute(object param);
canExecute(object param);
even CanExecuteChanged;
\end{verbatim}

Commands can be used on different UI Elements.

\begin{lstlisting}[caption = ICommand Implementation Example]
public class FooCommand : ICommand
{
 public Action<object> ExecuteDelegate { get; set; }
 public Func<object, bool> CanExecuteDelegate { get; set; }

 #region ICommand Members

 public bool CanExecute(object parameter)
 {
 return CanExecuteDelegate(parameter);
 }

 public event EventHandler CanExecuteChanged;

 public void Execute(object parameter)
 {
 ExecuteDelegate(parameter);
 }

 #endregion
 }
\end{lstlisting}

\chapter{Entity Framework}
\pic[Underlying Architecture 1]{ula.png}

\pic[Underlying Architecture 2]{ula_2.png}

\section{ADO.NET}
\textbf{klassenauflistung:}
\begin{itemize}
\item SqlConnection
\item SqlCommand
\item SqlCommandBuilder
\item SqlDataAdapter
\item SqlDataReader
\item SqlException
\item SqlParameter
\item SqlBulkCopy
\item SqlTransaction
\end{itemize}
\subsection{Examples}
\begin{lstlisting}[caption=DataSet Example]
using (SqlConnection cn = new SqlConnection("<connection string>") { 
	cn.Open(); 
	SqlDataAdapter ad = new OleDbDataAdapter("select * from products", cn);
	 DataSet ds = new DataSet();
	  ad.Fill(ds,"Products"); 
	  foreach(DataRow dr in ds.Tables["Products"].Rows) { 
	  Console.WriteLine(dr["ProductName"]); } 
	}
\end{lstlisting}
\section{Intro to Entity Framework}
\begin{description}
\item [EF] Maps conceptual model to physical tables, uses LINQ. Has features like change tracking identity resolution, 
lazy loading and more. 
\item [LINQ to SQL] Lightweight no mapping.Replaced by EF but still supported.
\item [NHibernate] Open Source like Entity Framework, uses LINQ.

\end{description}
\section{Architecture / Structure of EF}
\pic[EF Architecture]{efarch.png}

\begin{description}
\item[EDMX Files] \hfill \\
\pic[EDMX Files]{edmx1.png}
\pic[EDMX Files]{edmx2.png}
\item[Object Context (DB Context)] \hfill \\
\begin{verbatim}
Methods:
SaveChanges()
CreateObjectSet() (->LINQ-Query)
Attach() / Detach()
efresh()
Properties:
Connection
ObjectStateManger
\end{verbatim}
\item[Lazy Loading] Default, Eager loading - load everything - must be specified explicitly.
\item[StoredProcedure mapping] Usually sucks, maps to a single entity with one method to fetch the result of stored 
procedure, as dataset.
\end{description}
\section{"Variations" of Entity Framework}
\begin{description}
\item[Database First] : All code for Entities generated from database. (Model)
\item[Code First] No .edmx files, DB Schema and Entity Objects / Model from code. 
\item [Model first] Uses UI Designer, and edmx file with T4 Templating to generate Entity Objects and Context.
\end{description}

\section{Entity Objects}
\pic[Entity Framework Object using Model based approach]{efo1.png}
\pic[Object with Change Tracking]{efoa2.png}
\begin{description}
\item[Notes] Important to consider dev performance vs actual runtime performance because ORM means overhead.
\item [Design Consderations] \begin{itemize}
\item Encapsulate DAL implementation? (technology, connections, queries, structure)
\item Technology (ADO.NET vs. EF vs. ……)
\item Logical – physical model mapping?
\item Performance \& scalability
\item Batching: reduce round-trips (performance), Bulk insert/update: for large volumes
\item Use Views?
\item Use Stored Procedures?
\end{itemize}
\item[Benefits of ORM] \begin{itemize}
\item Decouples logical model from database model
\item Consistent, independent query language
\item Rich designer support
\item Most common patterns (1-to-many, many-to-1, many-to-many, self-referencing, inheritance,
\item Slower than ADO.NET core
\item Must regenerate EDM after DB changes
\end{itemize}
\end{description}

\section{First Steps}
\begin{lstlisting}[caption=Initial Entity Framework Example]
// create dbcontext 
AuctionContext context = new AuctionContext();
// get all auctions from database
 var myAuctions = context.Auctions;
// get all open auctions 
var openAuctions = context.Auctions.Where(a => a.EndTime < DateTime.Now);
// add new auction to database 
var newAuction = new Auction() {………} context.AddToAuctions(newAuction); context.SaveChanges();
\end{lstlisting}
\chapter{Dependency Injection with Unity}
\section{What is a dependency?}
Dependenencies in UML : \\
\pic[Depedency examples in UML]{dep.png}
\textbf{Common Dependencies in Enterprise Apps:}
\begin{description}
 \item [Application Layers] Data Access Layer \& Database dependencies, Dependencies between business layer, and DB 
Layer.
 \item [External Services and Components] Web Services, third party components.
 \item [.NET Components] File Objects / Http Objects (MVC) - HttpContext, Session.
\end{description}

\subsection{Tightly Coupled Dependencies (Bad)}
\begin{lstlisting}[caption=Bad DI Example]
 public class CustomerService : ICustomerService {
  #region ICustomerService Members
  public CustomerDTO GetACustomerFrom(int id)
{
    CustomerDTOMapper dtoMapper = new CustomerDTOMapper();
    CustomerRepository custRepository = new CustomerRepository();
    return dtoMapper.mapFrom(custRepository.getFrom(id));
 }
\end{lstlisting}

Problems :
\begin{itemize}
 \item Code is tightly coupled,difficult to isolate when testing, difficult to maintain. Changing out components not 
possible.
\end{itemize}
\textbf{Solutions:}
\begin{itemize}
 \item Inversion of Control - Hollywood principle.
 \item Dependency injection.
\end{itemize}
\section{What is Inversion of Control}
Higher level modules should not depend on lower level modules. Both should depend on abstractions (interfaces or 
abstract classes).\textit{Abstractions should not depend on details}
\subsection{IOC Implications}
\begin{itemize}
 \item Layers, modulariziation
 \item Interface based programming.
 \item Interface in seperate package to implementation.
 \item Implementations fetched through dependency injection.
 
\end{itemize}
\subsection{IOC Advantages}
\begin{itemize}
 \item Increase loose coupling
\subitem  Abstract interfaces don't change
\subitem  Concrete classes implement interfaces
\subitem  Concrete classes easy to throw away and replace
\item Increase mobility
\item Increase isolation
\subitem  decrease rigidity
\subitem Increase testability
\subitem Increase maintainability
\end{itemize}

\section{What is dependency injection}
\begin{description}
 \item [Purpose] How do we wire up concrete interfaces? DI gives us the ability to inject external dependency into 
component
\item DI is a form of IoC, where implementations are passed
into an object through constructors/setters/service look-
ups, which the object will 'depend' on in order to behave
correctly
\end{description}

\subsection{Dependency Options}
\begin{description}

\item [Option 1 – Factory] User depends on factory,factory depends on destination.
\item [Option 2 – Locator/Registry/Directory] The component still controls the wiring. Instantiation 
Sequence.Dependency 
on the Locator.
\item[Option 3 – Dependency Injection] An assembler controls the wiring
\end{description}

\subsection{Ways to inject dependencies}
\subsubsection{Constructor Injection}
\pic{constdi.png}
\subsubsection{Setter Injection}
\pic{setdi.png}
\subsubsection{Method Injection}
\pic{methdi.png}

\section{Pros and Cons of DI}
\begin{description}
 \item [+] Loosely Coupled
 \item [+] Better Testing
 \item [+] Allows IOC Container
\end{description}

\section{IOC Container Services}
\begin{itemize}
 \item Service Locator - Finds implementation of Interface based on wiring.
 \item Managing lifetime of dependencies. (Singleton, per http request etc)
 \item Automatic injection.
 \item Wiring config.
\end{itemize}

\section{IOC based Injection}
\pic[IOC based Injection]{iocinj.png}

\section{How to use Unity}
Unity container creates object instances during
resolution of types.Container must be asked to resolve a type.
\begin{lstlisting}[caption= DI Unity First Example]
  IUnityContainer container = new UnityContainer();
  IVideoSource source = container.resolve<IVideoSource>();
  IEnumerable<VideoSource> sources = container.ResolveAll<IVideoSource>();
\end{lstlisting}

\subsection{Resolving Dependencies (Wiring)}
Dependencies are wired up for resolved types\\
Properties marked as [Dependency]\\
Constructor marked [InjectionConstructor]\\
Methods marked [InjectionMethod]\\
Unity can also wire up dependencies on
objects not created by container

\textbf{Wiring Methods :}
\begin{tabular}{|c | c | c | c |}
  & Constructor & Properties & Method \\
  Resolve & Yes & Yes & Yes \\
  BuildUp & No & Yes & Yes \\
  
\end{tabular}
\begin{itemize}

\item Container has registration for object resolution
Maps interfaces and abstract base classes to
\item  Concrete types
\item Existing object instances
\item Performed only once per container instance
Can Use code or configuration
Register multiple types based on names

\end{itemize}

\pic[Sample Registration using Unity]{regdi.png}
\pic[Sample Registration in App.config]{regconf.png}

\section{Managing Lifetimes of Objects with Unity}
\begin{itemize}
\item Control the lifetime of objects created by Unity
Use LifetimeManager derived classes during
registration
\item Container controlled: singleton
\item  Transient: new every time, resolve is called
(default)
\item Externally managed: keeps weak references
\item RegisterInstance method: Singleton not created by container.
\end{itemize}
\part{Prüfung 2}
\chapter{ASP MVC4}
\section{Advantages of MVC}
\begin{itemize}
\item A new option for ASP.NET, not a replacement
for ASP.NET WebForms
\item Simple way to program ASP.NET
\item Easy testable
\item Much control over your <html>
\item Much control over your URLs
\item Can be used as a base infrastructure for SPA
\item Plays well with others : Entity Framework, Unity, Unit Testing
(Single Page Apps)
\end{itemize}
\section{Naming Conventions}
\pic[MVC Naming Conventions]{mvcname.png}
\section{MVC Sequence Diagram - How it works}
\pic[MVC Architecture]{mvcarch.png}
\section{Controllers}
\begin{itemize}
\item Controllers handle all incoming requests
\item Retrieve data from storage
\item Store posted data in storage (http post)
\item Pass the data to a View to generate the
\item HTML/CSS/JavaScript for display
\item Controllers can implement REST APIs
(derive controller from ApiController)
\item  The simplest controller just returns HTML to
the Web browser
\item IMPORTANT: By default, all public methods
in a controller class can be called from the
Web browser
\item Controllers give a ResultObject as return value and can be tested without the need for a webserver - Normal 
object.

\end{itemize}

\subsection{Controller Action Types}
\begin{tabular}{c | c | c}
Return Type & Content & Example  \\ \hline
 ViewResult & Html-Page & return View(); \\ \hline
 PartialViewResult & Part of HTML Page  & return PartialView()  \\ \hline
 RedirectResult & Redirect to other page & return Redirect(``url''); \\ \hline
 FileResult & Binary data & return File(``path''); \\ \hline
 JsonResult & Serialized JS Objects & return JSON(MyPOCO); \\ \hline
 JavaScriptResult & JS (AJAX) & return JavaScript(``alert('hi')''); \\ \hline

\end{tabular}

\subsection{Controllers and AJAX}
Ajax calls can also be handled by the
controller
These are also public methods:
\begin{verbatim}
 View:
@Ajax.ActionLink("Click me", "Click", null)
Controller:
public JavaScriptResult Click()
{
return JavaScript("alert('Hallo World');");
} 	
\end{verbatim}
\section{Passing Data between Controller and View}
\textbf{This part was not taken entirely from the slides because it was badly explained.}
\begin{enumerate}
 \item I can return a view with the View(Modelobject) method as follows :
 \begin{verbatim}
  public ActionResult Index()
{
return View(db.Item.ToList());
}
 \end{verbatim}
 This looks for view index.cshtml under views (matches method name). The parameter is the model object. 
\underline{Unless otherwise specified 
the view expects either no parameter or a parameter of type object, which can be accessed}

\end{enumerate}

\subsection{Viewbag}
\textbf{This is referred to in the slides as the untyped variant.} It IS NOT strictly speaking a variant. You are able 
to send data to the View using a model as above, and fill up the viewbag with objects (properties) at the same time.
\begin{lstlisting}[caption=ViewBag Example]
 ViewBag.Persons = new SelectList(context.People, "Id", "Name");
 //In View
 @Html.DropDownListFor(model => model.SellerId, (SelectList)ViewBag.Persons)
 
 //Combined Variant
 //Controller
   public ActionResult Index()
{
Object blab = new Object(); //can be anything
Viewbag.bla = blab
return View(db.Item.ToList());
}

 //In View
 <h2> Viewbag.blab.toString</h2>
 @Html.DropDownListFor(model => model.SellerId, (SelectList)ViewBag.Persons
 

\end{lstlisting}

\section{Razor View Engine}
Asp.Net classic view engine can be used but replaced by Razor.
Html tags implicitly identified and cause the code block to end.
If it doesnt work one can manually force a code block :

\begin{lstlisting}[caption=Normal Razor ASP.NET MVC,language=html]
 <h2>Products</h2>
 <ul>
    @foreach (var p in products) {
     <li> @p.ProductName </li>
    }
 <li>
\end{lstlisting}

\begin{lstlisting}[caption=Specified Code Block ASP.NET MVC,language=html]
\begin{lstlisting}
//@{code here} html stuff here. 
<div>
<b>
@if (HttpContext.Current.Request.IsAuthenticated)
{
@:Change your password:
}
else
{
@:Please change your initial password:
}
</b>
</div>
\end{lstlisting}

\section{View Helpers}
Methods that you can use in the view to generate HTML tags that correspond with properties of @model.
\begin{lstlisting}
 @Html.ActionLink(“Edit Record”, “Edit”, new {Id=3}):
 //generates:
<a href=”/Home/Edit/3′′>Edit Record</a>
@Html.LabelFor(model => model.FirstName):
//generates:
<label for="FirstName">FirstName</label>

@Html.EditorFor(model => model.FirstName):

//generates 
<input class="text-box single-line" data-val="true"
data-val-required="The FirstName field is required."
id="FirstName" name="FirstName" type="text" value="" />
\end{lstlisting}

\section{Layout}
This was also badly explained in the slides.
As we learn in web frameworks we need a template for every view. The template itsself is a view in ASP.NET mvc - 
layout.cshtml. The name for the template is specified in \_ViewStart.cshtml, doesnt have to be named layout.

\textit{The layout also has access to the Viewbag -}
\textbf{Whatever I put in the viewbag in a Controller method, can be displayed in the layout in non dynamic parts, if 
the property doesnt exist - an empty String is displayed (null)}
Example :
\pic[Layout Example] {layout_example.png}

\textbf{Requirement : Layout must contain @RenderBody that is all}

\section{Routing}
\begin{lstlisting}[caption=Routing Example]
App_Start/RouteConfig.cs
 routes.MapRoute(
"Default", // Route name
"{controller}/{action}/{id}", // URL with parameters
new { controller = "Home", action = "Index", id = UrlParameter.Optional } // Default
);
\end{lstlisting}
First route that matches url pattern "wins".

\section{Model binding}
Just like in Spring MVC or JSF the properties of the Model Object can be bound to form fields provided the fields are 
given suitable names so that the model binder knows what to bind. This is taken care of with the html helpers above. In 
other words manually making form fields is generally a bad idea.

\pic[Model binder]{mbinder.png}

If you really want to you can extract the values manually from the Request object :
\begin{lstlisting}[caption=Manual reading of form values (not recommended but just in case)]
 public ActionResult Create()
{
var product = new Product() {
AvailabilityDate =
DateTime.Parse(Request["availabilityDate"]),
CategoryId = Int32.Parse(Request["categoryId"]),
Description = Request["description"],
Kind =
(ProductKind)Enum.Parse(typeof(ProductKind),
Request["kind"]),
Name = Request["name"],
UnitPrice = Decimal.Parse(Request["unitPrice"]),
UnitsInStock =
Int32.Parse(Request["unitsInStock"]),
};
// do work
}
\end{lstlisting}

\begin{lstlisting}[caption=Model binding with primitive values]
 public ActionResult Create(
DateTime availabilityDate, int categoryId,
string description, ProductKind kind, string name,
decimal unitPrice, int unitsInStock
)
{
var product = new Product() {
AvailabilityDate = availabilityDate,
CategoryId = categoryId,
Description = description,
Kind = kind,
Name = name,
UnitPrice = unitPrice,
UnitsInStock = unitsInStock,
};
// do work
}
\end{lstlisting}

\begin{lstlisting}[caption=Model binding sensibly]
 public ActionResult Create(Product product)
{
// do work
}
\end{lstlisting}

\subsection{Hidden values}
@HiddenFor(model=>model.property) in the view.
Generates a hidden form field that is also mapped to the model later.

\subsection{Step by Step behind the curtain}
Value Sources: querystring parameters, form\\
fields and route data\\
Evaluation order:\\
\begin{itemize}
\item Previously bound action parameters, when the
action is a child action
\item Form fields (Request.Form)
\item The property values in the JSON Request body
(Request.InputStream), but only when the
request is an AJAX request
\item Route data (RouteData.Values)
\item Querystring parameters (Request.QueryString)
\item Posted files (Request.Files)
\end{itemize}

\section{Sessions}
\begin{lstlisting}[caption=using session in controller]
      public ActionResult Index(SessionAspDotNetMvcModel data)
        {
            // Assign value into session
            Session["SessionUserID"] = data.sUserID;
            // Redirect view
            return RedirectToAction("EmployeeSection");
        }
\end{lstlisting}

Session States :
\begin{description}
\item [InProc:] In memory on the Web server
(default)
\item [StateServer:] Separate process called the
ASP.NET state service
\item [SQLServer:] SQL Server database
Custom: Custom storage provider
\item [Off]
 
\end{description}

\chapter{Azure}

Cloud service : On demand , self service, and runs on pay per use principal.
Why cloud : Outsourcing of infrastructure, scalability.

\textbf{Cloud Service Types:}

\begin{description}
\item [IaaS:] Infrastructure as a Service - Virtual Machines (Virtual Private Server)
\item [PaaS:] Platform as a Service - \begin{itemize}
                                 \item Mobile Services
\item Cloud Services
\item  SQL Databases \& Reporting
\item  Storage
\item Service Bus
\item  Virtual Networks
\item Web Sites
                                \end{itemize}
                                
Important Characteristics : Usually automates deployment with possibilities for customization through scripts that you 
can add to the deployment process. Services like openshift for example deploy when you commit your project to the git 
repo.

[SaaS:] Software as a Service : Site builders and so on fully managed.

\end{description}

\section{Data Center Architecture}
\pic{dca.png}

\section{Windows Azure Portal}
\begin{description}

\item[Service Management Portal UI] Subscriptions (roles, URL, billing account) Hosted services, storage, SQL Azure 
and all the other services. Staging, production, updates.Create, configure, scale, monitor.\\
Built on top Azure Service Management.
REST APIs.\\
Multiple service administrators.\\
Get detailed billing information\\
\item [Modes] Free  - Limited VM \\
Shared VM - \$9.68\\
Standard : Separate VM -  \$75 to \$298
\item [PAAS Websites] Visual Studio helps, use publish button to send to Azure.
\item [IAAS Features] To migrate legacy applications. Full control over the OS Image. Create
your VHD locally and upload\\
Deploy a service package that
references and uses the custom
OS image\\
You maintain the OS (patch) With your tools. 
\end{description}
\subsection{PAAS in depth for Azure}
\begin{itemize}
 \item Auto scaling possible
Use Azure Diagnostics, avoid
logging to local discs
\item  Azure may “reimage” the VM any
time (after patch) -> this removes all
local data!
\item  Production \& staging environment
\item  Virtual IP address swap (easy testing
in staging, quick undo possible)
\end{itemize}

\subsubsection{Implementation}
\pic{implcl.png}

\section{Databases/Storage Account}
\begin{itemize}
\item Familiar SQL Server
 Support for existing APIs \& tools
\item Failover cluster, data stored on 3
different backend data nodes
150 GB limit - ``sharding''
\item No point in time backup!
\item Accessible with Management
Studio 
\end{itemize}

\pic[Database Syncing]{dbds.png}

Storage in DB :
\begin{itemize}
\item  blobs\footnote{Large binary - 200gb}, Tables \& Queues
\item Georeplication (immediately
consistent)
\item 100TB per storage account
\item Accessible via RESTful Web
Service API
Security: shared secret keys,
HTTPS endpoint
\end{itemize}

\subsection{Storage Types (Table,Queue)}
\begin{description}
 \item [Table] \begin{itemize}
              \item   Rows of entities
\item  Up to 255 properties per row
\item  Max. 1 MB per entity
\item  Partitioned by (partition) key
\item  Indexed by row key
\item Scales for large number
(billions) of entities
\item  Structured data, no fixed schema,
not an RDBMS.
\end{itemize}
\item[Queue] \begin{itemize}
              \item Any binary object can be queued
(64kB limit)
\item Use for Inter-role communication
\item  non transactional
\item  read at least once
\item  message invisible for timeout
\item  delete to remove message -
otherwise is returned to queue
\end{itemize}


\end{description}

\chapter{Windows Communication Foundation}

\section{Fundamentals}
\begin{itemize}
\item Is a runtime for message based communication
Is a development API
\subitem For creating systems that send messages between services and
clients
\subitem Unified API across different transport mechanisms
\item For applications that communicate with other
applications
\subitem On the same computer system
\subitem On external computer system
\subitem In another company accessible over the internet
\end{itemize}

\subsection{Service Orientation}
\begin{description}
 \item[Boundaries are Explicit] Developers opt-in to consuming, exposing,
and defining public-facing service façade.
\item [	Autonomous Evolution] Services and consumers are independently
versioned, deployed, operated, and
secured.
\item[Share Schema + Contract not class]Data never includes behavior;
Objects with data and behavior are a local
phenomenon.
\item[Compatability based on policy] Capabilities and requirements represented
by a unique public name; Used to establish
service suitability.

\end{description}

\subsection{Design Goals WCF}
\begin{description}
 \item [Unifaction] \begin{itemize}
                     \item Unified former distributed technology stacks
\item Composable functionality
\item Appropriate for use on-machine, in the intranet, and
cross the Internet
\end{itemize}
\item[Productive Service-Oriented Programming] \begin{itemize}
                                                \item Service-oriented programming model
\item Supports 4 tenets of service-orientation
\item Improve developer productivity
                                               \end{itemize}
\item[Interoperability \& Integration] \begin{itemize}
                                       \item WS-* interoperability with applications running on other platforms
\item Interoperability with today’s distributed stacks.
                                      \end{itemize}

\end{description}

\section{WCF Concepts}
\pic{cservice.png}
\pic{endp.png}
\pic{abc.png}
\pic[WCF Messaging Runtime]{wcfmr.png}
\begin{description}
 \item [Adressses] \texttt{http://www.mystore.com/StoreFront
net.tcp://mycomputer:9000/StoreFront}\\
Scheme:\\
HTTP, TCP, Named pipes, MSMQ, ...
Machine\\
\[Port\]\\
Path\\
\item[Contracts] Defines what a service communicates.
\end{description}

\section{Contracts,Behavior,Ways to Talk}
\begin{description}
 \item [Service Contract] Defines Operations, 
Behaviors and Communication Shape Map CLR types to WSD\footnote{Web Services Description Language} (what does your 
service do?)
\item [Data Contract] Defines Schema and Versioning Strategies Maps CLR types to XSD\footnote{XML Schema Definition}
\item [Message Contract] Allows defining application-specific headers and unwrapped body content Maps CLR types to SOAP 
messages.
\item[Binding] Describes how a service communicates : Set of binding elements :
\begin{itemize}
 \item Set of predefined standard bindings
\item Transport; http, tcp, np, msmq
\item Encoding format; text, binary, MTOM, ...
\item Security requirements
\item Reliable session requirements
\item Transaction requirements
\item Can be customized
\item Custom binding
\end{itemize}
\item[Behavior] Modifies or extends service or client runtime
behavior. Instancing; Singleton, PrivateSession,
SharedSession, PerCall  Concurrency; Multiple, Reentrant, Single, Throttling; connections, threading Metadata 
customization Transactions; AutoEnlist, Isolation, AutoComplete.
\pic{bbe.png}
\pic{bbs.png}
\item[Ways to talk] One way, Request - Reply, Duplex/Dual.
\end{description}

\section{Steps for Building a WCF App}
\begin{enumerate}
 \item Service
 \subitem Define Contracts
 \subitem Implement Contracts
  \subitem Define Endpoints. 
  \subitem Host and Run Service.
  \item Client.
  \subitem Generate Proxy from Metadata.
  \subitem Implement Run Client.
\end{enumerate}

\section{WCF Examples}
\subsection{Service Contract}
\begin{lstlisting}[caption=Define Service Contract]
 [ServiceContract]
public interface ICalculator
{
[OperationContract]
int Add(int a, int b);
// Not exposed as part of the external contract :-)
void MethodRequiredForImplementation(bool b);
}
\end{lstlisting}
\begin{lstlisting}[caption=Service Contract: One Way]
 [ServiceContract]
public interface ICalculator
{
[OperationContract]
int Add(int a, int b);
[OperationContract(IsOneWay=true)]
void StoreProblem (ComplexProblem p);
}
\end{lstlisting}
\begin{lstlisting}[caption=Service Contract:Duplex Asymmetric]
 [ServiceContract(Session=true,
CallbackContract=typeof(ICalculatorResults)]
public interface ICalculatorProblems
{
[OperationContract(IsOneWay=true)]
void SolveProblem (ComplexProblem p);
}
public interface ICalculatorResults
{
[OperationContract(IsOneWay=true)]
void Results(ComplexProblem p);
}
\end{lstlisting}
\subsection{Data Contract}
\begin{lstlisting}[caption=Defininbg a Data Contract]
 [DataContract]
public class ComplexNumber
{
[DataMember]
public double Real = 0.0D;
[DataMember]
public double Imaginary = 0.0D;
public ComplexNumber(double r, double i)
{
this.Real = r;
this.Imaginary = i;
}
}
\end{lstlisting}
\subsection{Message Contract}
\begin{lstlisting}[caption=Define Message Contract]
 [MessageContract]
public class ComplexProblem
{
[MessageHeader(Name="Op", MustUnderstand=true)]
public string operation;
[MessageBodyMember]
public ComplexNumber n1;
[MessageBodyMember]
public ComplexNumber n2;
[MessageBodyMember]
public ComplexNumber solution;
// Constructors...
}
\end{lstlisting}
\subsection{Bindings}
\begin{lstlisting}[caption=WCF Bindings,language=xml]
 <endpoint address="Calculator"
bindingSectionName="basicHttpBinding"
bindingConfiguration="UsernameBinding"
contractType="ICalculator" />
<bindings>
<basicHttpBinding>
<binding name="UsernameBinding"
messageEncoding="Mtom">
<security mode="Message">
<message clientCredentialType="UserName"/>
</security>
</binding>
</basicHttpBinding>
</bindings>
\end{lstlisting}

\section{Features Summary}
\pic{fs.png}

\section{Config (xml) based WCF}
\begin{lstlisting}[caption=Endpoints WCF Config,language=xml]
 <?xml version="1.0" encoding="utf-8" ?>
<configuration>
<system.serviceModel>
<services>
<service serviceType="CalculatorService">
<endpoint address="Calculator"
bindingSectionName="basicProfileBinding"
contract="ICalculator" />
</service>
</services>
</system.serviceModel>
</configuration>
\end{lstlisting}
\begin{lstlisting}[caption=Bindings WCF Config,language=xml]
 <endpoint address="Calculator"
bindingSectionName="basicProfileBinding"
bindingConfiguration="Binding1"
contractType="ICalculator" />
<bindings>
<basicProfileBinding>
<binding configurationName="Binding1"
hostnameComparisonMode="StrongWildcard"
transferTimeout="00:10:00"
maxMessageSize="65536"
messageEncoding="Text"
textEncoding="utf-8"
</binding>
</basicProfileBinding>
</bindings>
\end{lstlisting}
\begin{lstlisting}[caption=Custom Bindings]
 <bindings>
<customBinding>
<binding configurationName="Binding1">
<reliableSession bufferedMessagesQuota="32"
inactivityTimeout="00:10:00"
maxRetryCount="8"
ordered="true" />
<httpsTransport manualAddressing="false"
maxMessageSize="65536"
hostnameComparisonMode="StrongWildcard"/>
<textMessageEncoding maxReadPoolSize="64"
maxWritePoolSize="16"
messageVersion="Default"
encoding="utf-8" />
</binding>
</customBinding>
</bindings>
\end{lstlisting}

\section{WCF Summary}
\pic{ws.png}

\chapter{REST API MVC}
\section{Rest Basics}
\begin{description}
 \item [Definition] Style of software architecture for distributed systems
Term originated in a 2000 PhD written by Roy Fielding
one of the principal authors of the HTTP protocol specification
Term is also often used to describe any simple interface that
transmits domain-specific data over HTTP without an additional
messaging (e.g. SOAP) or session tracking (e.g. cookies)
\item [Principles] \hfill \\
\pic{restprin.png}
\pic{repor.png}
\begin{lstlisting}[caption=Verlingung mit Rest,language=xml]
 <order>
<date>16.03.2013</date>
<amount>23</amount>
<product ref="http://example.com/products/4711" />
<customer ref="http://example.com/customers/1234" />
</order>
\end{lstlisting}
\item[Error Codes]\begin{itemize}                   
 \item 201 Created
\item 200 Success/204 Success but No Content
\item 301 Uri Moved
\item 403 Not authorized
\item 404 Not Found / Does not exist
\item 405 Method not Allowed
\item 415 Unsupported Media Type
\item 500 Server Error
\end{itemize}
\item[Rest Steps] \begin{enumerate}
                   \item Give everything id, id is an uri.
                   \item Link things together using resource references.
                   \item Standard HTTP Methods (GET;POST;PUT;DELETE;)
                   \item Content negotiation URI based representations (Accept: application/xml) (foo.xml / foo.html / 
foo.json)
                   \end{enumerate}
\item[Common Patterns]
\begin{itemize}

\item GET /container List container content
\item POST /container Add item to container (with item in
    request)
\item URI of item returned in HTTP response header, e.g.
Location: http://host/container/item
\item DELETE /container
Remove container (including items)
\item GET /container/item Read item
\item PUT /container/item Update item (with updated item in request)
    DELETE /container/item Remove item 
\end{itemize}
\item[Rest vs SOAP] \hfill \\
\pic{rvs.png}

\end{description}

\section{WCF vs Web Api}
\begin{itemize}
 \item Service -> Web API controller
\item Operation -> Action
\item Service contract -> Not applicable
\item Endpoint -> Not applicable
\item URI templates -> ASP.NET Routing
\item Message handlers -> Same
\item Formatters -> Same
\item Operation handlers -> Filters, model binders
\end{itemize}
\pic{wcfwebapi.png}
\pic{wcfwapi2.png}

\section{Web Api Vorteile}
\begin{itemize}  \item Has
nothing to do with ASP.Net
\item New http object Model : HttpRequestMessage, HttpResponseMessage,
Headers, HttpContent
\item Code based config only.
\item Symmetry client, server, async apis.
\end{itemize}

\subsection{Integrated Stack}
\begin{itemize}
 \item Modern HTTP programming model
\item Full support for ASP.NET Routing
\item Content negotiation and custom formatters
\item Model binding and validation
\item Filters
\item Query composition
\item Easy to unit test
\item Improved Inversion of Control (IoC) via
\item DependencyResolver
\item Code-based configuration
\item Self-host
\end{itemize}

\section{Default Route (Important)}
\begin{framed}
 \begin{itemize}
  \item Default route will use http method for action
\item Controller/action/id
\item API/Controller/id GET/POST/PUT/DELETE
 \end{itemize}

\end{framed}

\section{Formate (XML JSON)}
\begin{itemize}
 \item XML tag based document formatting
\item Javascript Notation by Douglas Crockford
\item JSON less verbose than XML, more lightweight
\item Mobile devices have limited bandwidth
\item Set Xml or JSON based on Content-Type or Accept
header
\subitem Accept: application/xml
\item Can also use Odata
\end{itemize}

\section{Security in Web API}
\begin{verbatim}
[Authorize()]
https over port 443
Security Tokens
OAuth
 
\end{verbatim}

\subsection{Exkurs : Authorize}
\pic{webapi_auth01.png}
\begin{itemize}
 \item Globally: To restrict access for every Web API controller, add the AuthorizeAttribute filter to the global filter 
list
\begin{lstlisting}
 public static void Register(HttpConfiguration config)
{
    config.Filters.Add(new AuthorizeAttribute());
}

\end{lstlisting}
\item Controller: To restrict access for a specific controller, add the filter as an attribute to the controller:
\begin{lstlisting}
 // Require authorization for all actions on the controller.
[Authorize]
public class ValuesController : ApiController
{
    public HttpResponseMessage Get(int id) { ... }
    public HttpResponseMessage Post() { ... }
}
public class ValuesController : ApiController
{
    public HttpResponseMessage Get() { ... }

    // Require authorization for a specific action.
    [Authorize]
    public HttpResponseMessage Post() { ... }
}
// Restrict by user:
[Authorize(Users="Alice,Bob")]
public class ValuesController : ApiController
{
}
   
// Restrict by role:
[Authorize(Roles="Administrators")]
public class ValuesController : ApiController
{
}
\end{lstlisting}

\end{itemize}

\section{API Hosting}
\begin{description}
 \item [Web] Asp.net IIS
 \item [Self Hosting] Any .NET application can become a Web API server
 \item [In Memory] Whole pipeline in memory
 \item [OWIN (Open Web Interface for .NET)] Decouple web application from the host. 
\end{description}

\section{Building the API}
\begin{description}
 \item [Controllers] Represents a HTTP resource  Doesn’t have to map 1-to-1 to an entity!, Use http helpers to conform 
to http standards : [HttpGet] usw. Can Use IAssemblyResolver to load.
\item [Actions] Maps to an incoming HTTP request. \\
\begin{framed}
 Actions matched:\\
 \begin{verbatim}
  - by prefix (GetAll, GetById, Post(id),Put(id))
- by action attribute (i.e. [HttpPost]) 
 \end{verbatim}
\end{framed}
\pic{acpa.png}
\item[Action Return]Model / void, HttpResponseMessage , any CLR type, Work with HTTP concepts directly:\\
IHttpActionResult Predefined factories creating HttpResponseMessage\\
\begin{verbatim}
 public interface IHttpActionResult
{
Task<System.Net.Http.HttpResponseMessage> ExecuteAsync(CancellationToken cancellationToken);
}
\end{verbatim}
\item[Routing] \hfill \\
\pic{routing.png}
\item[Content Negotiation] \hfill \\
\pic{cn.png}
\pic{cn2.png}
\item[Testing] Browser tools Fiddler4

\end{description}

\chapter{Signal R}
Schlussendlich websockets über verschiedene Tech.
Higher Abstraction Level\\
Abstracts different technologies to push data\\
Websockets not required\\
Falls back to available technologies\\
Open source\\
Easier to use\\
SignalR extends ASP.NET\\
etect and handle connection states of
clients\\
Auto-reconnect after network failures ->
persistent connections\\Real-time” HTTP-based communication\\
framework
Runs in all browsers (JavaScript needed) \\
Server and client APIs:\\
 Client calls server\\
 Server calls client\\
 APIs for different client technologies (beyond
JavaScript)\\

\section{Hubs}
Hubs offer an application-level RPC style\\
Derived from
Microsoft.AspNet.SignalR.Hub\\
Abstraction on top of persistent connections\\
Hub conventions:
\begin{itemize}
\item Public methods are callable from the outside
\item  Send messages to clients by invoking hub
methods which are delegated to the clients
(dynamic, no type safety)
\end{itemize}

\pic{sighub.png}

\section{Hub Protocol}
Base endpoint is <MyURL>/signalr\\
Get JS metadata from <MyURL>/ signalr/hubs\\
Transport negotiation sequence:\\
\begin{enumerate}
\item Web Sockets
\item  2: Server Sent Event (SSE) (-> not supported by IE)
\item Forever frame
\item Long polling
\item Parameters are serialized to/from JSON
\end{enumerate}

\section{Pusing Data to Clients}
\pic{pdc.png}
\begin{lstlisting}[caption=Pushing Data to Clients]
 public class MyHub : Hub
{
public void SendHelloToAll()
{
Clients.All.broadcastMessage("Hello");
}
}
\end{lstlisting}
\begin{lstlisting}[caption=Hub Lifecycle]
 public class MyHub1 : Hub
{
public override Task OnConnected()
{
...
}
public override Task OnDisconnected()
{
...
}
public override Task OnReconnected()
{
...
}
}
\end{lstlisting}

\section{Hub Customers}

Many all platforms. Popular jquery api -  uses Late Binding / Generated Proxy.
\pic{jquerycode.png}

\section{Client Connection Steps}
\begin{itemize}
 \item Create Hubconnection
 \item Create hub proxy
 \item Wire up handlers via On(...)
 \item Call methods via invoke /lambda expr
\end{itemize}

\begin{lstlisting}[caption=client example signalr]
 static void Main(string[] args)
{
var hubConnection =
new HubConnection("http://xxx.azurewebsites.net");
var chat = hubConnection.CreateHubProxy("myHub");
chat.On<string>("newMessage", x => Console.WriteLine(x));
hubConnection.Start();
Console.ReadLine();
}
\end{lstlisting}

\chapter{Windows 8 Apps}
\section{Basics}
\begin{itemize}
 \item For Desktop+Tablet
 \item Businesses use Windows store or Side loading\footnote{Involves purchasing ``Enterprise Key'' from Microsoft}
 \item 2/3 c\# 1/3 html js (not run in browser)
 \item Touch enabled, full screen, Immersive, Managed lifecycle. 
 \item Metro apps can be ``snapped'' - View more then 1 app at the same time on screen. Make one smaller.
 \item Apps can have live tiles with updated info (Push notification)
 \item Charms - menu right hand side, context sensitive. 
 \item ``App Bar'' at bottom or top of screen replaces menus and toolbars.
\end{itemize}

\section{App Lifecycle}
\pic{al.png}
\begin{itemize}
 \item 3 App Sites :
 \subitem Running suspended, Not running / terminated.
 \item If app suspended, 5 seconds to restore state. 
 \subitem Subscribe to events, Incrementially save data, Save or restore data - user context.
 \item Templates in VS : Hub Application Class Library ,Portable Class Library (->usable on Desktop, WinRT, Windows 
Phone 8), Unit Test Library (all Windows Runtime)
\item Async api  many win rt functions async await.
\end{itemize}

\section{Capabilities}
Abilities that need to be enabled - permissions / features of device.
\pic{abil.png}

\section{Contracts}
Ability to make data available globally in winrt (to other applications) :
Search\\
Share Target \\
File Open Picker (Skydrive, ...)\\
File Save Picker\\
Contact Picker\\
Print Task Settings\\
Protocol\\
File Association\\

\section{Layout Conventions}
\begin{itemize}
\item Align everything to 20x20 pixel grid
\subitem Shape outlines
\subitem Text baselines
\item Standard font sizes/line heights
\subitem 12/20, 14.67/20, 26.67/32, 56/64
\item Standard content area margin
\subitem Top: 7 units (140px)
\subitem Heading Baseline: 5 units (100px)
\subitem Left: 6 units (120px)
\end{itemize}

\section{Semantic Zoom}
Two Elements with Syncronzied Scrolling :
\pic{semz.png}

\section{Application State and Session State, Disc Access}
\begin{description}
 \item [App State] No explicit save for app state, do it manually often.
 \item [Session State] Navigation, UI, scroll positions-
\item[Disc Access] In container, no direct access to disc:\\
\begin{verbatim}
 Windows.ApplicationModel.Package.Current.Inst
alledLocation
ApplicationData.Current.LocalFolder
 ApplicationData.Current.TemporaryFolder

\end{verbatim}
\end{description}

\section{How to launch an App using Contracts}
\pic{lac.png}

\section{Application Manifest + Packaging + Deployment}
\pic{am.png}
\subsection{Packaging apps}
Right click project click store, click create app packages, follow wizard.
\subsection{Deployment}
Deployed in store after verification / with "Side Loading Key" - Then an .appx package is created with a powershell 
script that installs it using the given key on the computer. 

\section{Azure Mobile Services}

\subsection{Definition}
\begin{itemize}
 \item Generic framework to create backend services. Built with Node js based on Azure websites. Creates a common 
backend that works for multiple mobile platforms. 
\pic{azarch.png}
\item Data Source : Crud Rest API orientated Models. 
\item Identity / OAUTH : Out of the box (Facebook, Google , Twitter)
\item Compatability for Android PUSH, APN (Apple) + Windows Mobile / Store. 
\item Dynamic DB Schema Creation : Created on first use. Can be switched off for production.
\end{itemize}

\subsection{Data Access}
\pic{azda.png}
\pic{azda2.png}
\pic{azda3.png}
\pic{azda4.png}
\pic{azda5.png}
\pic{azda6.png}
\begin{lstlisting}[caption=Azure web services Data Access]
 IMobileServiceTable<TodoItem> todoTable =
App.MobileService.GetTable<TodoItem>();
await todoTable.InsertAsync(newItem);
\end{lstlisting}
\begin{lstlisting}[language=JavaScript]
 exports.post = function(request, response)
{
// Use "request.service" to access
// features of your mobile service:
// var tables = request.service.tables;
// var push = request.service.push;
response.send(200, "Hello World");
};
\end{lstlisting}
\subsubsection{Scheduling}
Scripts can be executed as a type of cron job.

\subsection{Authentication with OAuth}
\pic{oa1.png}
\pic{oa2.png}

\begin{framed}
 Restrict permissions in settings afterward
\end{framed}
\pic{oalog.png}

\section{Push Notifications}
Common high level notification pattern:\\
1. Client retrieves its handle\\
2. Client stores handle in app backend\\
3. App backend contacts PNS\\
4. PNS forwards notification\\
Note : Platform specific infrastructure, no common interface - problematic.\\
\textbf{Solution windows azure notification hub}\\

\subsection{Notification Hub}
Multiplatform push notification infrastructure\\
- Platform-independent messages\\
- Scale out\\
- Sends push notifications from any backend
(in the cloud or on-premises) to any mobile
platform


\part{Code}
\chapter{Code Prüfung 1}

\begin{lstlisting}[caption=Converter WPF]
using System;
using System.Windows.Data;

namespace Fhnw.Dnead.Auction.WpfClient.Converter
{
    /// <summary>
    /// Converts booleans to Offen/Abgeschlossen strings
    /// </summary>
    [ValueConversion(typeof(bool), typeof(String))]
    public class BooleanToStatusTextConverter : IValueConverter
    {
        public object Convert(object value, Type targetType, object parameter, System.Globalization.CultureInfo 
culture)
        {
            if (value == null)
            {
                return null;
            }

            return (bool)value?"Offen":"Abgeschlossen";
        }
        public object ConvertBack(object value, Type targetType, object parameter, System.Globalization.CultureInfo 
culture)
        {
            // we don't intend this to ever be called
            return null;
        }
    }
}
\end{lstlisting}

\begin{lstlisting}[caption= Using a viewModel in View]
 using System.Windows;
using Fhnw.Dnead.Auction.WpfClient.ViewModels;

namespace Fhnw.Dnead.Auction.WpfClient.Views
{
    /// <summary>
    /// Interaction logic for MainWindow.xaml
    /// </summary>
    public partial class MainWindow : Window
    {
       MainViewModel viewModel = new MainViewModel();

       public MainWindow()
        {

            InitializeComponent();

            DataContext = viewModel;

        }

        private void btnSell_Click(object sender, RoutedEventArgs e)
        {
            var sellView = new SellView();

            if (sellView.ShowDialog().Value == true)
            {
                viewModel.Auctions.Add(sellView.ViewModel.NewAuctionItem);
            }
        }

        private void btnBuy_Click(object sender, RoutedEventArgs e)
        {
            Auction selectedAuction = (Auction)dgAuctionItems.SelectedItem
            var bidView = new BidView(selectedAuction);
            bidView.ShowDialog();
        }
    }
}
\end{lstlisting}
\begin{lstlisting}[caption=ViewModel/Business logic]
 using System;
using System.Globalization;
using System.IO;
using System.Windows;
using System.Windows.Input;
using Fhnw.Dnead.Auction.WpfClient.Commands;

namespace Fhnw.Dnead.Auction.WpfClient.ViewModels
{
    public class SellViewModel : ViewModelBase
    {
        private DelegateCommand<Window> _okCommand;

       public Auction NewAuctionItem { get; private set; }

        public string Name { get; set; }
        public string StartPrice { get; set; }
        public string EndTime { get; set; }
        private string picturePath ;
        public string PicturePath
        {
            get { return picturePath;  }
            set{
            
                picturePath = value;
                    if (picturePath != null && (picturePath.Length > 0))
                {
                                    #region 2. Extension: Image Preview - Enables preview of the selected image
                Picture = ReadPicture(picturePath);
                #endregion
                }
            }
        }

        private byte[] picture;

        public byte[] Picture { get { return picture; }
            set { picture = value;
                NotifyPropertyChanged("Picture");
            }
        }

        public SellViewModel()
        {
            EndTime = DateTime.Now.AddDays(7).ToString(CultureInfo.CurrentCulture);

            Name = "?";
            StartPrice = "1";
            
        }
        /// <summary>
        /// Validates if all data are correctly provided for the new auction

        /// Creates a new NewAuctionItem property instance.
        /// </summary>
        /// <returns>true if OK, else false</returns>
        public bool ValidateEntries()
        {
            if (Name.Length == 0) return false;
            int startPrice;

            if (!int.TryParse(StartPrice, out startPrice)) return false;
            if (startPrice == 0) return false;
            DateTime endTime;
            if (!DateTime.TryParse(EndTime, out endTime)) return false;
            if (endTime < DateTime.Now) return false;
            if (Picture != null && PicturePath.Length > 0 && !File.Exists(PicturePath)) return false;

            // create new auction item and initialize it

            NewAuctionItem = new Auction

            {
                Name = this.Name,
                StartPrice = startPrice,
                Seller = Environment.UserName,
                EndTime = endTime,
                Open = true,
                StartTime = DateTime.Now,

                #region 1. Extension: Read picture
                // optional: read picture
                Picture = ReadPicture(PicturePath)
                #endregion
            };
            return true;
        }

        #region 1. Extension: Read picture (2. part)
        /// <summary>
        /// Helper method to read the selected picture
        /// </summary>
        /// <returns></returns>
        private byte[] ReadPicture(string filename)
        {
            // basic check if there is a filename
            if (string.IsNullOrEmpty(filename))
            {
                return null;
            }

            using (FileStream fileStream = new FileStream(filename, FileMode.Open))
            {
                using (BinaryReader reader = new BinaryReader(fileStream))
                {
                    byte[] buffer = new byte[fileStream.Length];
                    reader.Read(buffer, 0, Convert.ToInt32(fileStream.Length));
                    return buffer;
                }
            }
        }
        #endregion

        public ICommand OkCommand
        {
            get
            {
                if (_okCommand == null)
                {
                    _okCommand = new DelegateCommand<Window>(DoOk, CanDoOk);

                }
                return _okCommand;
            }
        }

        void DoOk(Window win)
        {
            if (ValidateEntries() == true)
            {
                win.DialogResult = true;
            }
        }

        bool CanDoOk(Window win) { return true; }
    }
}
\end{lstlisting}

\begin{lstlisting}[caption=sample edmx file,language=xml]
 <?xml version="1.0" encoding="utf-8"?>

<edmx:Edmx Version="3.0" xmlns:edmx="http://schemas.microsoft.com/ado/2009/11/edmx">

  <!-- EF Runtime content -->

  <edmx:Runtime>

    <!-- SSDL content -->

    <edmx:StorageModels>

      <Schema Namespace="AuctionModel.Store" Alias="Self" Provider="System.Data.SqlClient" ProviderManifestToken="2008" 
xmlns:store="http://schemas.microsoft.com/ado/2007/12/edm/EntityStoreSchemaGenerator" 
xmlns="http://schemas.microsoft.com/ado/2009/11/edm/ssdl">

        <EntityContainer Name="AuctionModelStoreContainer">

          <EntitySet Name="Auction" EntityType="AuctionModel.Store.Auction" store:Type="Tables" Schema="dbo" />

        </EntityContainer>

        <EntityType Name="Auction">

          <Key>

            <PropertyRef Name="Id" />

          </Key>

          <Property Name="Id" Type="int" Nullable="false" StoreGeneratedPattern="Identity" />

          <Property Name="Name" Type="nchar" Nullable="false" MaxLength="50" />

          <Property Name="StartPrice" Type="int" Nullable="false" />

          <Property Name="Bid" Type="int" />

          <Property Name="StartTime" Type="datetime" Nullable="false" />

          <Property Name="EndTime" Type="datetime" Nullable="false" />

          <Property Name="Seller" Type="nchar" Nullable="false" MaxLength="50" />

          <Property Name="Buyer" Type="nchar" MaxLength="50" />

          <Property Name="Open" Type="bit" Nullable="false" />

          <Property Name="Picture" Type="image" />

        </EntityType>

      </Schema>

    </edmx:StorageModels>

    <!-- CSDL content -->

    <edmx:ConceptualModels>

      <Schema Namespace="AuctionModel" Alias="Self" p1:UseStrongSpatialTypes="false" 
xmlns:annotation="http://schemas.microsoft.com/ado/2009/02/edm/annotation" 
xmlns:p1="http://schemas.microsoft.com/ado/2009/02/edm/annotation" 
xmlns="http://schemas.microsoft.com/ado/2009/11/edm">

        <EntityContainer Name="AuctionContext" p1:LazyLoadingEnabled="true">

          <EntitySet Name="Auctions" EntityType="AuctionModel.Auction" />

        </EntityContainer>

        <EntityType Name="Auction">

          <Key>

            <PropertyRef Name="Id" />

          </Key>

          <Property Name="Id" Type="Int32" Nullable="false" p1:StoreGeneratedPattern="Identity" />

          <Property Name="Name" Type="String" Nullable="false" MaxLength="50" Unicode="true" FixedLength="true" />

          <Property Name="StartPrice" Type="Int32" Nullable="false" />

          <Property Name="Bid" Type="Int32" />

          <Property Name="StartTime" Type="DateTime" Nullable="false" Precision="3" />

          <Property Name="EndTime" Type="DateTime" Nullable="false" Precision="3" />

          <Property Name="Seller" Type="String" Nullable="false" MaxLength="50" Unicode="true" FixedLength="true" />

          <Property Name="Buyer" Type="String" MaxLength="50" Unicode="true" FixedLength="true" />

          <Property Name="Open" Type="Boolean" Nullable="false" />

          <Property Name="Picture" Type="Binary" MaxLength="Max" FixedLength="false" />

        </EntityType>

      </Schema>

    </edmx:ConceptualModels>

    <!-- C-S mapping content -->

    <edmx:Mappings>

      <Mapping Space="C-S" xmlns="http://schemas.microsoft.com/ado/2009/11/mapping/cs">

        <EntityContainerMapping StorageEntityContainer="AuctionModelStoreContainer" 
CdmEntityContainer="AuctionContext">

          <EntitySetMapping Name="Auctions">

            <EntityTypeMapping TypeName="AuctionModel.Auction">

              <MappingFragment StoreEntitySet="Auction">

                <ScalarProperty Name="Id" ColumnName="Id" />

                <ScalarProperty Name="Name" ColumnName="Name" />

                <ScalarProperty Name="StartPrice" ColumnName="StartPrice" />

                <ScalarProperty Name="Bid" ColumnName="Bid" />

                <ScalarProperty Name="StartTime" ColumnName="StartTime" />

                <ScalarProperty Name="EndTime" ColumnName="EndTime" />

                <ScalarProperty Name="Seller" ColumnName="Seller" />

                <ScalarProperty Name="Buyer" ColumnName="Buyer" />

                <ScalarProperty Name="Open" ColumnName="Open" />

                <ScalarProperty Name="Picture" ColumnName="Picture" />

              </MappingFragment>

            </EntityTypeMapping>

          </EntitySetMapping>

        </EntityContainerMapping>

      </Mapping>

    </edmx:Mappings>

  </edmx:Runtime>

  <!-- EF Designer content (DO NOT EDIT MANUALLY BELOW HERE) -->

  <Designer xmlns="http://schemas.microsoft.com/ado/2009/11/edmx">

    <Connection>

      <DesignerInfoPropertySet>

        <DesignerProperty Name="MetadataArtifactProcessing" Value="EmbedInOutputAssembly" />

      </DesignerInfoPropertySet>

    </Connection>

    <Options>

      <DesignerInfoPropertySet>

        <DesignerProperty Name="ValidateOnBuild" Value="true" />

        <DesignerProperty Name="EnablePluralization" Value="False" />

        <DesignerProperty Name="IncludeForeignKeysInModel" Value="True" />

        <DesignerProperty Name="CodeGenerationStrategy" Value="None" />

      </DesignerInfoPropertySet>

    </Options>

    <!-- Diagram content (shape and connector positions) -->

    <Diagrams></Diagrams>

  </Designer>

</edmx:Edmx>
\end{lstlisting}

\begin{lstlisting}[caption=Unity Example]
 IUnityContainer myContainer = new UnityContainer();
myContainer.RegisterType<MyBaseService, CustomerService>();
MyBaseService myServiceInstance = myContainer.Resolve<MyBaseService>();


IUnityContainer myContainer = new UnityContainer();
myContainer.RegisterType(typeof(MyBaseService), typeof(CustomerService));
MyBaseService myServiceInstance = (MyBaseService)myContainer.Resolve(typeof(MyBaseService));

// Create container and register types
IUnityContainer myContainer = new UnityContainer();
myContainer.RegisterType<IMyService, DataService>("Data");
myContainer.RegisterType<IMyService, LoggingService>("Logging");

// Retrieve an instance of each type
IMyService myDataService = myContainer.Resolve<IMyService>("Data");
IMyService myLoggingService = myContainer.Resolve<IMyService>("Logging");

// Create container and register types using a name for each one
IUnityContainer myContainer = new UnityContainer();
myContainer.RegisterType<IMyService, DefaultService>();
myContainer.RegisterType<IMyService, DataService>("Data");
myContainer.RegisterType<IMyService, LoggingService>("Logging");

// Retrieve a list of non-default types registered for IMyService
// List will only contain the types DataService and LoggingService
IEnumerable<IMyService> serviceList = myContainer.ResolveAll<IMyService>();


// Create container and register types using a name for each one
IUnityContainer myContainer = new UnityContainer();
myContainer.RegisterType(typeof(MyServiceBase), typeof(DefaultService));
myContainer.RegisterType(typeof(MyServiceBase), typeof(DataService), "Data");
myContainer.RegisterType(typeof(MyServiceBase), typeof(LoggingService), "Logging");

// Retrieve a list of non-default types registered for MyServiceBase
// List will only contain the types DataService and LoggingService
foreach(Object mapping in myContainer.ResolveAll(typeof(MyServiceBase)))
{
  MyServiceBase myService = (MyServiceBase)mapping;
}


\end{lstlisting}

\begin{lstlisting}[caption=Constructor Injection]
public class MyObject
{
  public MyObject(MyDependentClass myInstance)
  { 
    // work with the dependent instance
    myInstance.SomeProperty = "SomeValue";
    // or assign it to a class-level variable
  }
} 


IUnityContainer uContainer = new UnityContainer();
MyObject myInstance = uContainer.Resolve<MyObject>();

IUnityContainer uContainer = new UnityContainer()
   .RegisterType<IMyInterface, FirstObject>()
   .RegisterType<MyBaseClass, SecondObject>();
MyObject myInstance = uContainer.Resolve<MyObject>();



//Multiple-Constructor Injection Using an Attribute

public class MyObject
{

  public MyObject(SomeOtherClass myObjA)
  { 
    ...
  }

  [InjectionConstructor]
  public MyObject(MyDependentClass myObjB)
  { 
    ...
  }

} 
IUnityContainer uContainer = new UnityContainer();
MyObject myInstance = uContainer.Resolve<MyObject>();

  



\end{lstlisting}

\chapter{Code Prüfung 2}
\begin{lstlisting}[caption=WebApi Example]
 using System;
using System.Collections.Generic;
using System.Linq;
using System.Net;
using System.Net.Http;
using System.Web.Http;
using ProductStoreWebApiService.Models;

namespace ProductStoreWebApiService.Controllers
{
    public class ProductsController : ApiController
    {

        static readonly IProductRepository repository = new ProductRepository();

        public IEnumerable<Product> GetAllProducts()
        {
            return repository.GetAll();
        }

        public Product GetProduct(int id)
        {
            Product item = repository.Get(id);
            if (item == null)
            {
                throw new HttpResponseException(HttpStatusCode.NotFound);
            }
            return item;
        }

        public IEnumerable<Product> GetProductsByCategory(string category)
        {
            return repository.GetAll().Where(
                p => string.Equals(p.Category, category, StringComparison.OrdinalIgnoreCase));
        }

        public HttpResponseMessage PostProduct(Product item)
        {
            item = repository.Add(item);
            var response = Request.CreateResponse<Product>(HttpStatusCode.Created, item);

            string uri = Url.Link("DefaultApi", new { id = item.Id });
            response.Headers.Location = new Uri(uri);
            return response;
        }

        public void PutProduct(int id, Product product)
        {
            product.Id = id;
            if (!repository.Update(product))
            {
                throw new HttpResponseException(HttpStatusCode.NotFound);
            }
        }

        public void DeleteProduct(int id)
        {
            Product item = repository.Get(id);
            if (item == null)
            {
                throw new HttpResponseException(HttpStatusCode.NotFound);
            }

            repository.Remove(id);
        }
    }
}
\end{lstlisting}

\begin{lstlisting}[caption=signalr example 1]
 namespace MvcApplication1
{
    public class MyHub : Hub
    {
        public void AddMessage(string nick, string message)
        {
            Clients.All.newMessage(nick, message);
        }
    }
}

namespace MvcApplication1
{
    public class RouteConfig
    {
        public static void RegisterRoutes(RouteCollection routes)
        {
            routes.IgnoreRoute("{resource}.axd/{*pathInfo}");

            routes.MapRoute(
                name: "Default",
                url: "{controller}/{action}/{id}",
                defaults: new { controller = "Home", action = "Chat", id = UrlParameter.Optional }
            );
        }
    }
}

<div class="container"> 
    <input type="text" id="message" />
    <input type="text" id="nick" />
<input type="button" id="sendmessage" value="Send" />
<ul id="discussion"></ul>
</div>
@section scripts {
<script src="~/Scripts/jquery.signalR-2.0.0.min.js"></script>
<script src="~/signalr/hubs"></script>
<script>
    $(function () {
        $.connection.myHub.client.newMessage = function (nick, message) {
            // Add the message to the page.
            $('#discussion').append('<li>' + nick + ', ' + message + '</li>');
        };
        $.connection.hub.start();
        $('#sendmessage').click(function () {
            // Call the Send method on the hub.
            $.connection.myHub.server.addMessage($('#nick').val(), $('#message').val());
        });
    });
</script>
}

namespace MvcApplication1
{
    public class Startup
    {
        public void Configuration(IAppBuilder app)
        {
            app.MapSignalR();
        }
    }
} 
\end{lstlisting}
\begin{lstlisting}[caption=wcf example]
 namespace CurrencyConverterServices
{
    [ServiceContract]
    public interface ICurrencyConverterService
    {
        [OperationContract]
        string GetData(int value);

        [OperationContract]
        CompositeType GetDataUsingDataContract(CompositeType composite);

        [OperationContract]
        CurrencyExchange Convert(Money sourceMoney, CurrencyCode targetCurrency);
    }
    // Use a data contract as illustrated in the sample below to add composite types to service operations.
    // You can add XSD files into the project. After building the project, you can directly use the data types defined 
there, with the namespace "CurrencyConverterService.ContractType".
    [DataContract]
    public class CompositeType
    {
        bool boolValue = true;
        string stringValue = "Hello ";
        [DataMember]
        public bool BoolValue
        {
            get { return boolValue; }
            set { boolValue = value; }
        }
        [DataMember]
        public string StringValue
        {
            get { return stringValue; }
            set { stringValue = value; }
        }
    }
}

namespace CurrencyConverterServices
{
    public class CurrencyConverterService : ICurrencyConverterService
    {
        public string GetData(int value)
        {
            return string.Format("You entered: {0}", value);
        }
        public CompositeType GetDataUsingDataContract(CompositeType composite)
        {
            if (composite == null)
            {
                throw new ArgumentNullException("composite");
            }
            if (composite.BoolValue)
            {
                composite.StringValue += "Suffix";
            }
            return composite;
        }
        public CurrencyExchange Convert(Money sourceMoney, CurrencyCode targetCurrency)
        {
            CurrencyConverter cc = new CurrencyConverter();
            return cc.Convert(sourceMoney, targetCurrency);
        }
    }
}

namespace CurrencyConverterLib
{
    [DataContract]
    public enum CurrencyCode { [EnumMember]USD, [EnumMember]EUR, [EnumMember]CHF };
}

namespace CurrencyConverterLib
{
    [DataContract]
    public class Money
    {
        public Money(CurrencyCode currencyCode, double amount)
        {
            Currency = currencyCode;
            Amount = amount;
        }
        [DataMember]
        public CurrencyCode Currency { get; set; }

        [DataMember]
        public double Amount { get; set; }
    }
}

<?xml version="1.0" encoding="utf-8" ?>
<configuration>

  <appSettings>
    <add key="aspnet:UseTaskFriendlySynchronizationContext" value="true" />
  </appSettings>
  <system.web>
    <compilation debug="true" />
  </system.web>
  <!-- When deploying the service library project, the content of the config file must be added to the host's 
  app.config file. System.Configuration does not support config files for libraries. -->
  <system.serviceModel>
    <services>
      <service name="CurrencyConverterServices.CurrencyConverterService">
        <endpoint address="" binding="basicHttpBinding" contract="CurrencyConverterServices.ICurrencyConverterService">
          <identity>
            <dns value="localhost" />
          </identity>
        </endpoint>
        <endpoint address="mex" binding="mexHttpBinding" contract="IMetadataExchange" />
        <host>
          <baseAddresses>
            <add baseAddress="http://localhost:8733/Design_Time_Addresses/CurrencyConverterService/Service1/" />
          </baseAddresses>
        </host>
      </service>
    </services>
    <behaviors>
      <serviceBehaviors>
        <behavior>
          <!-- To avoid disclosing metadata information, 
          set the values below to false before deployment -->
          <serviceMetadata httpGetEnabled="True" httpsGetEnabled="True"/>
          <!-- To receive exception details in faults for debugging purposes, 
          set the value below to true.  Set to false before deployment 
          to avoid disclosing exception information -->
          <serviceDebug includeExceptionDetailInFaults="False" />
        </behavior>
      </serviceBehaviors>
    </behaviors>
  </system.serviceModel>

</configuration>
\end{lstlisting}
\begin{lstlisting}[caption=wcf self host]
 // program.cs
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.ServiceModel;
using GettingStartedLib;
using System.ServiceModel.Description; 

namespace GettingStartedHost
{
    class Program
    {
        static void Main(string[] args)
        {
            // Step 1 Create a URI to serve as the base address.
            Uri baseAddress = new Uri("http://localhost:8000/GettingStarted/");

            // Step 2 Create a ServiceHost instance
            ServiceHost selfHost = new ServiceHost(typeof(CalculatorService), baseAddress);

            try
            {
                // Step 3 Add a service endpoint.
                selfHost.AddServiceEndpoint(typeof(ICalculator), new WSHttpBinding(), "CalculatorService");

                // Step 4 Enable metadata exchange.
                ServiceMetadataBehavior smb = new ServiceMetadataBehavior();
                smb.HttpGetEnabled = true;
                selfHost.Description.Behaviors.Add(smb);

                // Step 5 Start the service.
                selfHost.Open();
                Console.WriteLine("The service is ready.");
                Console.WriteLine("Press <ENTER> to terminate service.");
                Console.WriteLine();
                Console.ReadLine();

                // Close the ServiceHostBase to shutdown the service.
                selfHost.Close();
            }
            catch (CommunicationException ce)
            {
                Console.WriteLine("An exception occurred: {0}", ce.Message);
                selfHost.Abort();
            }
        }
    }
}
\end{lstlisting}
\begin{lstlisting}[caption=wcf client side]
svcutil.exe /language:cs /out:generatedProxy.cs /config:app.config http://localhost:8000/ServiceModelSamples/service
 using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using GettingStartedClient.ServiceReference1;

namespace GettingStartedClient
{
    class Program
    {
        static void Main(string[] args)
        {
            //Step 1: Create an instance of the WCF proxy.
            CalculatorClient client = new CalculatorClient();

            // Step 2: Call the service operations.
            // Call the Add service operation.
            double value1 = 100.00D;
            double value2 = 15.99D;
            double result = client.Add(value1, value2);
            Console.WriteLine("Add({0},{1}) = {2}", value1, value2, result);

            // Call the Subtract service operation.
            value1 = 145.00D;
            value2 = 76.54D;
            result = client.Subtract(value1, value2);
            Console.WriteLine("Subtract({0},{1}) = {2}", value1, value2, result);

            // Call the Multiply service operation.
            value1 = 9.00D;
            value2 = 81.25D;
            result = client.Multiply(value1, value2);
            Console.WriteLine("Multiply({0},{1}) = {2}", value1, value2, result);

            // Call the Divide service operation.
            value1 = 22.00D;
            value2 = 7.00D;
            result = client.Divide(value1, value2);
            Console.WriteLine("Divide({0},{1}) = {2}", value1, value2, result);

            //Step 3: Closing the client gracefully closes the connection and cleans up resources.
            client.Close();
        }
    }
}
\end{lstlisting}
\begin{lstlisting}[caption=signalr js]
var myConnection = $.connection("/chat");
Next, the received event is set up to display a received chat message as a new list item element in the messages 
unordered list DOM element:

myConnection.received(function (data) {
        $("#messages").append("<li>" + data.Name + ': ' + data.Message + "</li>");
    });
 
\end{lstlisting}


\end{document}
